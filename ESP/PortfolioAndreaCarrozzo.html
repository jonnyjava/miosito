<div class="row">
  <div class="eight columns alpha box">
    <div class="subtitulo"> 
      <img src="img/work.png" alt="Trabajos" title="Trabajos" class="icon"/> 
      <span>Trabajos</span>
    </div>
    <div class="texto portfolio">
      <div class="containerficha js_embed" data-tag="work">
      </div>
      <div id="work_navigator"></div>
    </div>
  </div>

  <div class="eight columns alpha box">
    <div class="subtitulo"> 
      <img src="img/freelance.png" alt="Proyectos como Freelance" title="Proyectos como Freelance" class="icon"/> 
      <span>Proyectos Universitarios</span>
    </div>
    <div class="texto portfolio">
      <div class="containerficha js_embed" data-tag="free">
      </div>
      <div id="free_navigator"></div>
    </div>
  </div>

  <div class="row">

  <div class="eight columns alpha box">
    <div class="subtitulo"> 
      <img src="img/demo.png" alt="Productos y Demos" title="Productos y Demos" class="icon"/> 
      <span>Productos y Demos</span>
    </div>
    <div class="texto portfolio">
      <div class="containerficha js_embed" data-tag="demo">
      </div>
    </div>
  </div>

  <div class="eight columns alpha box">
    <div class="subtitulo"> 
      <img src="img/uni.png" alt="Proyectos Universitarios" title="Proyectos Universitarios" class="icon"/> 
      <span>Proyectos Universitarios</span>
    </div>
    <div class="texto portfolio">
      <div class="containerficha js_embed" data-tag="uni">
      </div>
      <div id="uni_navigator"></div>
    </div>
  </div>
</div>
<script type="text/javascript">
  embed_json();

  function buildPage(deck){
    $.each(deck, function(key, val) {
      $("div[data-tag='"+key+"']").append(deck[key]);
      $("#"+key+"_navigator").load("partials/_"+key+"_navigator.html");
    });
    embedGoToPage();
  }

  function embed_json(){
    var deck = {};
    $.getJSON("partials/portfolioTexts.json",{}).done(function(data){
      $.each(data, function(key, val) {
        deck[key] = "";
      });
      $.each(data, function(key, val) {
        deck[key] += createDeck(key, val);
      });
      buildPage(deck);
    });
  }

  function createDeck(key, val){
    var deck = "";
    $.each( val, function( index, item ) {
      var image = getImage(item);
      var allTexts = getTexts(item);
      var link = getLink(item);
      var icons = createIcons(item.icons.split(", "));
      var card = "<div class='containerficha'><div id='"+key+"container"+(index+1)+"' class='ficha'>"+image+"<div class='three columns alpha omega'>"+icons+link+"</div>"+allTexts+"</div></div>";
      deck += card;
    });
    return deck;
 }

  function getLink(item){
    return "<a href='"+item.link+"' target='_blank' class='js_linkToPage'></a>";
  }

  function getImage(item){
    return "<div class='four columns '><img src='img/"+item.image+".png' alt='"+item.imgTitle+"' title='"+item.imgTitle+"' class='ficha' border='0' /></div>";
  }

  function getTexts(item){
    return "<div class='seven columns'><p><b>"+item.title+"</b><br/>"+item.description+"</p></div>";
  }

  function createIcons(arrayIcons){
   var icons = "<div class='board'>";
   for(var i = 0; i< arrayIcons.length; i++){
     if(i%2==0){ icons += "<div class='omega bigicon "+arrayIcons[i]+"'></div>"; }
     else{ icons += "<div class='bigicon "+arrayIcons[i]+"'></div>"; }
   }
   icons += "</div>";
   return icons;
  }

  function embedGoToPage(){
    var linkToPage = "<div class='link'><span>Ir a la pagina web</span><div class='bottonemini go'></div></div>"
    $('.js_linkToPage').html(linkToPage);
  }
</script>
